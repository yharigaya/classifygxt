<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform BMS for classifying GxT interactions — do_bms • classifygxt</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform BMS for classifying GxT interactions — do_bms"><meta property="og:description" content="This function takes as input individual phenotype and genotype data
and performs BMS for a feature-SNP pair (or a SNP). The output
includes posterior probabilities of different types of GxT
interactions as well as the log marginal likelihood, which can be
used for optimizing the hyperparameter values by an empirical Bayes
approach. BMS is performed by either MCMC followed by bridge
sampling or MAP estimation followed by Laplace approximation. In
the latter case, a relative marginal likelihood is returned. That
is, the log marginal likelihood value is shifted by a
constant. Note that this shift does not affect the posterior
probabilities or hyperparameter optimization.
tu.lambda must be supplied when modeling a random effect."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">classifygxt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/classifygxt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform BMS for classifying GxT interactions</h1>
    
    <div class="hidden name"><code>do_bms.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes as input individual phenotype and genotype data
and performs BMS for a feature-SNP pair (or a SNP). The output
includes posterior probabilities of different types of GxT
interactions as well as the log marginal likelihood, which can be
used for optimizing the hyperparameter values by an empirical Bayes
approach. BMS is performed by either MCMC followed by bridge
sampling or MAP estimation followed by Laplace approximation. In
the latter case, a relative marginal likelihood is returned. That
is, the log marginal likelihood value is shifted by a
constant. Note that this shift does not affect the posterior
probabilities or hyperparameter optimization.
<code>tu.lambda</code> must be supplied when modeling a random effect.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">do_bms</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">fn</span>,</span>
<span>  rint <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  p.m <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">phi</span>,</span>
<span>  phi0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>  kappa <span class="op">=</span> <span class="fl">0.002</span>,</span>
<span>  nu <span class="op">=</span> <span class="fl">0.002</span>,</span>
<span>  kappa.u <span class="op">=</span> <span class="fl">0.002</span>,</span>
<span>  nu.u <span class="op">=</span> <span class="fl">0.002</span>,</span>
<span>  tu.lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  summary <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n.cores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A list containing vectors of subjects, genotypes,
phenotypes, and treatment indicators, which must be named
"subject", "g", "y", and "t", respectively.</p></dd>


<dt>fn</dt>
<dd><p>A character string specifying the function. This must be
one of "nonlinear" and "linear", corresponding to nonlinear and
linear models, respectively.</p></dd>


<dt>rint</dt>
<dd><p>A logical as to whether the phenotypes need to be
RINT-transformed. This cannot be set to <code>TRUE</code> if <code>fn</code> is
set to "nonlinear".</p></dd>


<dt>method</dt>
<dd><p>A character string spcifying the method for parameter
estimation and computation of the marginal likelihood. This
must be eigher "mcmc.bs", for MCMC followed by bridge sampling,
or "map.lap", for MAP estimation
followed by Laplace approximation.</p></dd>


<dt>p.m</dt>
<dd><p>A vector of hyperparameters of the model prior.</p></dd>


<dt>phi</dt>
<dd><p>A vector of hyperparameters of the effect prior.</p></dd>


<dt>phi0</dt>
<dd><p>A scalar specifying the hyperparameter on the intercept.</p></dd>


<dt>kappa</dt>
<dd><p>A scalar specifying the hyperparameter of the gamma
prior on the residual error precision.</p></dd>


<dt>nu</dt>
<dd><p>A scalar specifying the hyperparameter of the gamma prior
on the residual error precision.</p></dd>


<dt>kappa.u</dt>
<dd><p>A scalar specifying the hyperparameter of the gamma
prior on the random intercept.</p></dd>


<dt>nu.u</dt>
<dd><p>A scalar specifying the hyperparameter of the gamma
prior on the random intercept.</p></dd>


<dt>tu.lambda</dt>
<dd><p>A list obtained from
<code><a href="get_tu_lambda.html">get_tu_lambda</a></code>. It must contain the transposed
eigen vector matrix and the eigen values of the covariance
matrix. The element names must be "tU" and "lambda".</p></dd>


<dt>summary</dt>
<dd><p>A Boolean variable indicating whether a summary or
MCMC samples should be stored. This is only applicable when
<code>method</code> is set to "mcmc.bs".</p></dd>


<dt>seed</dt>
<dd><p>An integer specifying a seed for RNG.</p></dd>


<dt>n.cores</dt>
<dd><p>An integer specifying the number of cores.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list object containing:</p><ul><li><p><code>fn</code> -  A character string specifying the function.</p></li>
<li><p><code>ranef</code> - A logical.</p></li>
<li><p><code>rint</code> - A logical as to whether the phenotypes have
been RINT-transformed.</p></li>
<li><p><code>p.m</code> - A vector of hyperparameters of the model prior.</p></li>
<li><p><code>seed</code> - A integer specifying a seed fo RNG.</p></li>
<li><p><code>ln.p.y.given.m</code> - A named vector of the log marginal
likelihood given each model. If <code>method</code> is set to
"map.lap", the value is shifted by a constant.</p></li>
<li><p><code>ln.p.y</code> - A scalar value of the log marginal
likelihood. If <code>method</code> is set to "map.lap", the value is
shifted by a constant.</p></li>
<li><p><code>p.m.given.y</code> - A named vector of posterior probability of the
models.</p></li>
<li><p><code>ml.errors</code> - A named vector of errors in the log marginal
likelihood. This element is included only when <code>method</code> is
set to "mcmc.bs".</p></li>
<li><p><code>stan.list</code> - A list of <code>stanfit</code> objects or data frames
containing MCMC results for all eight models. This element is inclued only when
<code>method</code> is set to "mcmc.bs". If <code>summary</code> is set to
<code>TRUE</code>, a list of data frames containing posterior summary
is returned. If the option is set to <code>FALSE</code>, a list of
<code>stanfit</code> objects is returned.</p></li>
<li><p><code>optim.list</code> - A list of outputs from the <code>optim</code>
function from the <code>stat</code> package containing MAP
estimates and Hessian. This element is included only when
<code>method</code> is set to "map.lap".</p></li>
</ul></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yuriko Harigaya, Michael Love, William Valdar.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

